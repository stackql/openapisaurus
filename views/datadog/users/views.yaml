vw_users:
  name: vw_users
  id: datadog.users.vw_users
  config:
    views:
      select:
        predicate: sqlDialect == "sqlite3"
        ddl: |-
          SELECT
          id,
          JSON_EXTRACT(attributes, '$.name') as name,
          JSON_EXTRACT(attributes, '$.email') as email,
          JSON_EXTRACT(attributes, '$.handle') as handle,
          JSON_EXTRACT(attributes, '$.title') as title,
          JSON_EXTRACT(attributes, '$.status') as status,
          CASE 
          WHEN JSON_EXTRACT(attributes, '$.mfa_enabled') = 1 THEN 'true'
          ELSE 'false' 
          END as mfa_enabled,
          CASE 
          WHEN JSON_EXTRACT(attributes, '$.verified') = 1 THEN 'true'
          ELSE 'false' 
          END as verified,
          CASE 
          WHEN JSON_EXTRACT(attributes, '$.disabled') = 1 THEN 'true'
          ELSE 'false' 
          END as disabled,          
          CASE 
          WHEN JSON_EXTRACT(attributes, '$.service_account') = 1 THEN 'true'
          ELSE 'false' 
          END as service_account,
          JSON_EXTRACT(attributes, '$.icon') as icon,
          JSON_EXTRACT(attributes, '$.allowed_login_methods') as allowed_login_methods,
          JSON_EXTRACT(attributes, '$.created_at') as created_at,
          JSON_EXTRACT(attributes, '$.modified_at') as modified_at
          FROM
          datadog.users.users
          WHERE dd_site = 'us3.datadoghq.com'